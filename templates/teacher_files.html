<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>My Folders & Files</title>
 
  <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}" />
  <style>
  .diacard {
      width: 360px;
	  max-width: 90%;
      background:linear-gradient(90deg,#64C4FF ,#357abd);
	padding :24px 32px;
     border-radius:12px;
	 border: 1px solid rgba(0, 255, 0,0.2);
	 box-shadow: 0 8px 30px rgba(255, 255, 255, 0.2);
      transform-style: preserve-3d;
      perspective: 1000px;
	  animation: fadeIn 1s ease;
	 
    }
	h3 {
      color: white;
     
      
    }
  </style>
</head>
<body>
<header>
    <div class="brand">
      <div class="logo">
        <img src="{{ url_for('static', filename='images/cat.png') }}" alt="Cat Logo">
      </div>
       <h1> Hello, {{ session['teacher_name'] }} </h1>
    </div>
  <nav>
  <a href="{{ url_for('logout') }}">Logout</a></nav>
  </header>
 
  

  <section>
  <center>
	<div class="card">
    <h2>Folders</h2>
    <form method="POST" action="{{ url_for('folder_create') }}" class="inline">
      <input name="name" placeholder="New folder name" required />
      <button type="submit">Create Folder</button>
    </form>
	</div>
    {% if folders %}
      <table>
        <tr><th>Name</th><th>Created</th><th>Rename</th><th>Delete</th></tr>
        {% for f in folders %}
        <tr>
          <td>{{ f['name'] }}</td>
          <td>{{ f['created_at'] }}</td>
          <td>
            <form method="POST" action="{{ url_for('folder_rename', folder_id=f['id']) }}">
              <input name="name" placeholder="New name" required />
              <button type="submit">Rename</button>
            </form>
          </td>
          <td><p><a class="btn" href="{{ url_for('folder_delete', folder_id=f['id']) }}" onclick="return confirm('Delete folder? Make sure it is empty.');">Delete</a></p></td>
        </tr>
        {% endfor %}
      </table>
    {% else %}
      <p>No folders yet.</p>
    {% endif %}
  </section>
	<center>
  <section class="card" >
  
    <h2>My Files</h2>
    <p><a class="btn" href="{{ url_for('upload') }}">Upload a New File</a></p>
    {% if files %}
    <table>
      <tr><th>File</th><th>Subject</th><th>Folder</th><th>Uploaded</th><th>Actions</th></tr>
      {% for f in files %}
      <tr>
        <td>{{ f['file_name'] }}</td>
        <td>{{ f['subject'] or '-' }}</td>
        <td>{{ f['folder_name'] or '-' }}</td>
        <td>{{ f['upload_date'] }}</td>
        <td>
          <p><a class="btn" href="{{ url_for('download_file', filename=f['file_path']) }}">Download</a></p>
          <p><a class="btn" href="{{ url_for('file_delete', file_id=f['id']) }}" onclick="return confirm('Delete this file?');">Delete</a></p>
        </td>
      </tr>
      {% endfor %}
    </table>
    {% else %}
      <p>No files uploaded yet.</p>
    {% endif %}
  </section>

  
</body>
<script src="{{ url_for('static',filename='js/dialog.js')}}"></script>
<script>
const msgs = {{ get_flashed_messages() | tojson }};
msgs.forEach(m => { alertCustom(m);});
</script>
</html>
